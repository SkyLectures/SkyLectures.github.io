---
layout: page
title:  "데이터 생성 및 전처리"
date:   2025-03-01 10:00:00 +0900
permalink: /materials/S03-05-04-02_01-DataGenerationPreprocessing
categories: materials
---
* toc
{:toc .large-only .toc-sticky:true}


## 1. LLM 기반의 데이터 생성 및 전처리 개요

- LLM의 강력한 자연어 처리 능력을 활용하여 특정 목적에 맞는 데이터를 효율적으로 생성하거나, 
- 기존 데이터를 분석 및 정제하여 모델 학습이나 특정 작업에 적합하게 만드는 기술

## 2. LLM 기반 데이터 생성

- LLM은 텍스트 생성 능력뿐만 아니라, 주어진 프롬프트에 따라 다양한 형태의 데이터를 생성하는 데 활용될 수 있음
- 이는 데이터 증강, 합성 데이터 생성, 특정 스타일의 콘텐츠 제작 등 다양한 분야에서 유용하게 사용됨

### 2.1 주요 활용 분야

- 텍스트 데이터 증강
    - 부족한 데이터를 LLM을 이용하여 유사하거나 변형된 형태로 생성하여
    - 모델의 일반화 성능을 향상시킬 수 있음

- 합성 데이터 생성
    - 실제 데이터 수집이 어렵거나 개인 정보 보호 등의 이유로 접근이 제한적인 경우,
    - LLM을 이용하여 현실과 유사한 합성 데이터를 생성할 수 있음

- 특정 스타일 콘텐츠 생성
    - 광고 문구, 소셜 미디어 게시물, 이메일 템플릿 등
    - 특정 스타일과 목적에 맞는 텍스트 콘텐츠를 대량으로 생성할 수 있음

- 테이블 형식 데이터 생성
    - LLM을 활용하여 자연어 설명을 기반으로 테이블 형태의 데이터를 생성하거나
    - 기존 테이블 데이터를 변형할 수 있음

- 코드 생성
    - 특정 프로그래밍 언어나 프레임워크에 대한 설명을 바탕으로 코드를 생성하거나
    - 기존 코드를 변환할 수 있음

### 2.2 생성 예제

#### 2.2.1 텍스트 데이터 증강 예제(질의-응답 쌍 생성)

- 파이썬 코드를 이용하여 생성할 수도 있고, Web UI를 이용하여 생성할 수도 있음
- 파이썬 코드를 이용할 경우, 원하는 형태의 데이터로 구성 및 저장하도록 작성할 수 있음

    ```python
    prompt = """
    다음 질문에 대한 답변을 다양한 표현으로 3가지 생성해주세요.

    질문: 오늘 날씨 어때?
    """

    response = model.generate(prompt, max_length=200)
    print(response)
    ```

- 예상 결과

    ```text
    답변 1: 오늘 날씨는 화창합니다. 기온은 25도로 야외 활동하기 좋은 날씨입니다.
    답변 2: 현재 날씨는 맑고 쾌적하며, 25도 정도의 온도로 바깥에 나가기 딱 좋습니다.
    답변 3: 오늘, 25도의 맑은 날씨가 예상됩니다. 외출하기에 좋은 날씨네요.
    ```

#### 2.2.2 합성 데이터 생성 예제(이커머스 상품 설명 생성)

- 파이썬 코드를 이용하여 생성할 수도 있고, Web UI를 이용하여 생성할 수도 있음
- 파이썬 코드를 이용할 경우, 원하는 형태의 데이터로 구성 및 저장하도록 작성할 수 있음

    ```python
    prompt = """
    다음 상품 속성을 기반으로 매력적인 상품 설명을 2가지 생성해주세요.

    상품명: 프리미엄 유기농 녹차
    브랜드: 자연의 선물
    특징: 부드러운 맛, 풍부한 항산화 성분, 제주도 유기농 밭에서 재배
    용량: 100g
    """

    response = model.generate(prompt, max_length=300)
    print(response)
    ```

- 예상 결과

    ```text
    상품 설명 1: 자연의 싱그러움을 그대로 담은 '자연의 선물 프리미엄 유기농 녹차'를 만나보세요. 청정한 제주도 유기농 밭에서 정성껏 재배하여 부드러운 맛과 풍부한 항산화 성분을 자랑합니다. 100g 용량으로 여러분의 일상에 건강과 여유를 더해보세요.
    상품 설명 2: 지친 일상에 활력을 불어넣어 줄 '자연의 선물 프리미엄 유기농 녹차'입니다. 제주도의 깨끗한 자연 환경에서 자란 유기농 찻잎만을 엄선하여, 은은하고 깊은 풍미와 몸에 좋은 항산화 성분을 가득 담았습니다. 100g으로 오랫동안 그 특별한 맛과 향을 즐기실 수 있습니다.
    ```

## 3. LLM 기반 데이터 전처리

- LLM은 텍스트 데이터의 품질을 향상시키고, 특정 분석이나 모델 학습에 적합한 형태로 변환하는 다양한 전처리 작업에 효과적으로 활용될 수 있음

### 3.1 주요 활용 분야

- 텍스트 정제
    - 불필요한 특수 문자, HTML 태그, 이모티콘 등을 제거하고 텍스트를 정규화

- 오류 수정
    - 문법 오류, 철자 오류, 비표준어 등을 LLM의 문맥 이해 능력을 활용하여 수정

- 텍스트 요약
    - 긴 텍스트를 핵심 내용을 중심으로 간결하게 요약

- 감성 분석
    - 텍스트에 나타난 감정을 긍정, 부정, 중립 등으로 분류

- 개체명 인식 (Named Entity Recognition, NER)
    - 텍스트에서 사람, 장소, 조직, 날짜 등 특정 개체명을 식별하고 분류

- 관계 추출 (Relation Extraction)
    - 텍스트에 나타난 개체들 간의 관계를 파악

- 텍스트 분류
    - 텍스트의 내용을 기반으로 미리 정의된 범주로 분류

- 의미 기반 텍스트 변환 (Semantic Text Transformation)
    - 단어 임베딩 등을 활용하여 텍스트를 의미 공간상의 벡터로 변환

### 3.2 전처리 예제

#### 3.2.1 텍스트 정제 및 오류 수정 예제

```python
raw_text = "오늘 날씨는 넘나 조아요!! <br> 담주에 벚꽃축제 한다는데 진짜?? 기대된당^^"

prompt = f"""
다음 텍스트를 문법 및 맞춤법에 맞게 수정하고 불필요한 특수문자나 HTML 태그, 이모티콘 등을 제거해주세요.

텍스트: {raw_text}
"""

response = model.generate(prompt, max_length=200)
print(response)
```

- **예상 결과:**

    ```
    오늘 날씨는 정말 좋아요. 다음 주에 벚꽃 축제를 한다는데 정말인가요? 기대돼요.
    ```

#### 3.2.2 텍스트 요약

```python
long_text = """
인공지능(AI) 기술이 빠르게 발전하면서 다양한 산업 분야에서 혁신적인 변화를 가져오고 있습니다. 특히 자연어 처리(NLP) 분야에서는 대규모 언어 모델(LLM)의 등장으로 이전에는 상상하기 어려웠던 수준의 텍스트 이해 및 생성 능력이 가능하게 되었습니다. LLM은 방대한 양의 텍스트 데이터를 학습하여 문맥을 파악하고, 인간과 유사한 자연스러운 텍스트를 생성할 수 있으며, 질문 답변, 텍스트 요약, 번역 등 다양한 NLP task에서 뛰어난 성능을 보이고 있습니다. 이러한 LLM의 발전은 우리의 소통 방식, 정보 접근 방식, 그리고 업무 생산성에 큰 영향을 미칠 것으로 예상됩니다.
"""

prompt = f"""
다음 텍스트를 핵심 내용을 중심으로 3문장으로 요약해주세요.

텍스트: {long_text}
"""

response = model.generate(prompt, max_length=150)
print(response)
```

- **예상 결과:**

    ```
    인공지능 기술 발전, 특히 LLM 등장으로 자연어 처리 분야에서 혁신적인 발전이 이루어졌습니다. LLM은 방대한 데이터를 학습하여 인간과 유사한 텍스트 생성 및 이해 능력을 갖추고 다양한 NLP task에서 뛰어난 성능을 보입니다. 이러한 LLM의 발전은 소통, 정보 접근, 업무 생산성에 큰 영향을 미칠 것으로 예상됩니다.
    ```

## 4. 주의사항 및 고려사항

- **프롬프트 엔지니어링**
    - LLM 기반 데이터 생성 및 전처리의 성능은 프롬프트의 품질에 크게 의존함
    - 명확하고 구체적인 지시를 담은 프롬프트를 설계하는 것이 중요함

- **모델의 편향성**
    - LLM은 학습 데이터에 내재된 편향성을 그대로 반영할 수 있음
    - 생성되거나 전처리된 데이터가 편향되지 않도록 주의해야 함

- **데이터 품질 검증**
    - LLM이 생성한 데이터는 항상 사람이 검토하여 품질을 확인하는 것이 좋음

- **비용 및 자원**
    - LLM 사용에는 비용이 발생할 수 있으며
    - 복잡한 작업에는 상당한 컴퓨팅 자원이 필요할 수 있음
